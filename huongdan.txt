---
cai dat armbian orange pi pc
dung nmap -sP 192.168.1.1/24 de do tim orange pi pc tren LAN
ssh root@<ipv4>
pass:1234

---
sau do
create new pass for root
create new user:dungnt
create new pass for dungnt
thay doi cach bieu dien thong tin, chon no
tiep tuc chon 153 roi an enter
thoat exit
---
dang nhap bang ssh dungnt@<ipv4>
chay git clone https://github.com/dungbkhn/ssf.git
cd ssf, gan chmod 755 cho file start.sh va chay file nay voi sudo voi 1 argument la dungnt

=============================================================================

tao file setup_for_root_crontab.sh, thiet lap chmod 755 cho no
=====
#!/bin/bash
shopt -s dotglob
shopt -s nullglob

if [ $# -ne 1 ] ; then
        echo 'need 1 param'
        exit 1
fi

p1=$1
echo $p1

if [ ! -d /home/$p1 ] ; then
        echo 'directory not exists'
        exit 1
fi

rm /home/$p1/mount_ok.txt
rm /home/$p1/mount_not_ok.txt

cd /home/$p1/ChangeRemoteInfo
node server.js &

cd /home/$p1

COUNTER=0

while true;
do
  rs=$(/sbin/fdisk -l | grep "/dev/sda")
  
  if [ "$rs" != "" ] ; then
    echo 'mount first time'
    mount /dev/sda1 /var/res/backup     
    chgrp -R $p1 /var/res/backup
    chown $p1 /var/res/backup
    chmod 755 /var/res/backup
    touch /home/$p1/mount_ok.txt    
    break
  fi
  
  COUNTER=$(( COUNTER + 1 ))
  
  if [ $COUNTER -eq 3 ] ; then
    echo 'mount first time not ok'
    touch /home/$p1/mount_not_ok.txt
    break
  fi
  
  sleep 3
done

=====
tao file setup_for_crontab.sh, thiet lap chmod 755 cho no
=====
#!/bin/bash
shopt -s dotglob
shopt -s nullglob

if [ $# -ne 1 ] ; then
        echo 'need 1 param'
        exit 1
fi

p1=$1
echo $p1

if [ ! -d /home/$p1 ] ; then
        echo 'directory not exists'
        exit 1
fi

sleep 2

cd /home/$p1/CreateRemoteLink
node server.js &
cd /home/$p1/autotox
#./autotox &
chmod 777 reset_att.sh
./reset_att.sh &

cd /home/$p1

while true;
do
  if [ -f /home/$p1/mount_ok.txt ] ; then
    echo 'syncthing first time'
    syncthing &
    rm -f /home/$p1/mount_ok.txt
    break
  fi
  
  if [ -f /home/$p1/mount_not_ok.txt ] ; then
    echo 'syncthing first time not ok'
    rm -f /home/$p1/mount_not_ok.txt
    break
  fi
  
  sleep 3
done


=====

thiep lap trong crontab
sudo crontab -e
roi them dong sau
@reboot /home/dungnt/setup_for_root_crontab.sh

-----

crontab -e
roi them dong sau
@reboot /home/dungnt/setup_for_crontab.sh

---
+neu usb chua chua du lieu sync:
cam usb vao, format bang mkfs.ext4 /dev/sda1
xoa thu muc lost+found trong usb vua format
khoi dong lai orange pi pc
+neu usb dang chua du lieu sync: cam usb vao roi khoi dong lai orange pi pc
---
tu add crontab bang: /var/spool/cron/crontabs
